const express=require("express"),mongoose=require("mongoose"),path=require("path"),config=require("config"),app=express();app.use(express.json());const db=config.get("mongoURI")||config.get(process.env.mongoURI);mongoose.connect(db,{useNewUrlParser:!0,useUnifiedTopology:!0,useCreateIndex:!0,useFindAndModify:!1}).then(()=>console.log("MongoDB Connected successfully...")).catch(err=>console.log(err)),app.use("/api/items",require("./routes/api/items")),app.use("/api/users",require("./routes/api/users")),app.use("/api/auth",require("./routes/api/auth")),"production"===process.env.NODE_ENV&&(app.use(express.static("client/dist",{maxAge:"1y"})),app.get("*",(req,res)=>{res.sendFile(path.resolve(__dirname,"client","dist","index.html"))}));const port=process.env.PORT||5e3;app.listen(port,()=>console.log(`Server started on port ${port}`));